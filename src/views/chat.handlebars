<link rel="stylesheet" href="/css/styles.css">

<div class="container">
  <div class="linea-horizontal"></div>
  <div class="menu-container">
    <div class="logo">
      <a href="/">
        <img src="/img/2.png" alt="Logo de la empresa">
      </a>
    </div>
    <div class="menu">
        <span class="separator">|</span>
        <a href="/login" class="menu-item">Iniciar Sesión</a>
        <span class="separator">|</span>
        <a href="/register" class="menu-item">Registrarme</a>
        <span class="separator">|</span>
        <a href="/products" class="menu-item">Productos</a>
        <span class="separator">|</span>
    </div>
  </div>

  <div class="chat-container">
    <h1>Bienvenido al Chat</h1>
    <div id="message-history" class="message-history">
      {{#each messages}}
      <p>{{this.user}} dice: {{this.message}}</p>
      {{/each}}
    </div>

    <form id="message-form" class="message-form">
      <input type="text" id="message" name="message" placeholder="Escribe tu mensaje aquí" required>
      <button type="submit">Enviar</button>
    </form>
  </div>

  <div class="linea-horizontal2"></div>
</div>

<script src="https://cdn.socket.io/4.7.4/socket.io.min.js"></script>
<script>
  const socket = io();

  const sendMessage = (event) => {
    event.preventDefault();
    const messageInput = document.getElementById("message");
    const message = messageInput.value.trim();
    if (message !== "") {
      socket.emit("message", { user: "Usuario", message: message });
      messageInput.value = "";
    }
  };

  document.getElementById("message-form").addEventListener("submit", sendMessage);

  socket.on("message", (data) => {
    const messageHistory = document.getElementById("message-history");
    const messageElement = document.createElement("p");
    messageElement.textContent = `${data.user} dice: ${data.message}`;
    messageHistory.appendChild(messageElement);
    messageHistory.scrollTop = messageHistory.scrollHeight;
  });
</script>